{% extends "base.html" %} {% block title %}Register — PlagCheck{% endblock %} {%
block extra_head %}
<style>
  .auth-wrap {
    min-height: calc(100vh - 60px);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 40px 16px;
    background: linear-gradient(135deg, #f8fafc 0%, #eff6ff 100%);
  }
  .auth-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    box-shadow: var(--shadow-md);
    width: 100%;
    max-width: 520px;
    padding: 36px;
  }
  .auth-logo {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 24px;
  }
  .auth-logo svg {
    color: var(--accent);
  }
  .auth-logo span {
    font-weight: 700;
    font-size: 18px;
  }
  .auth-title {
    font-size: 20px;
    font-weight: 700;
    margin-bottom: 4px;
  }
  .auth-sub {
    color: var(--text-2);
    margin-bottom: 22px;
    font-size: 14px;
  }

  .role-select-group {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-bottom: 22px;
  }
  .role-option {
    display: none;
  }
  .role-label {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 14px;
    border: 2px solid var(--border);
    border-radius: var(--radius);
    cursor: pointer;
    transition: all 0.15s;
    gap: 6px;
  }
  .role-label svg {
    color: var(--text-3);
    transition: color 0.15s;
  }
  .role-label span {
    font-size: 13px;
    font-weight: 500;
    color: var(--text-2);
  }
  .role-option:checked + .role-label {
    border-color: var(--accent);
    background: var(--accent-bg);
  }
  .role-option:checked + .role-label svg {
    color: var(--accent);
  }
  .role-option:checked + .role-label span {
    color: var(--accent);
  }

  .auth-footer {
    text-align: center;
    margin-top: 18px;
    font-size: 13px;
    color: var(--text-2);
  }
  .auth-footer a {
    color: var(--accent);
    font-weight: 500;
    text-decoration: none;
  }
</style>
{% endblock %} {% block content %}
<div class="auth-wrap">
  <div class="auth-card">
    <div class="auth-logo">
      <svg
        width="22"
        height="22"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path
          d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"
        />
      </svg>
      <span>PlagCheck</span>
    </div>

    <h1 class="auth-title">Create an account</h1>
    <p class="auth-sub">Fill in the details below to get started.</p>

    {% if error %}
    <div class="alert alert-error">{{ error }}</div>
    {% endif %}

    <form method="post" action="/register">
      <!-- Role selector -->
      <div class="form-group">
        <label class="form-label">Select Role <span>*</span></label>
        <div class="role-select-group">
          <div>
            <input
              class="role-option"
              type="radio"
              name="role"
              id="role-student"
              value="Student"
              checked
            />
            <label class="role-label" for="role-student">
              <svg
                width="22"
                height="22"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2" />
                <circle cx="9" cy="7" r="4" />
                <path d="M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75" />
              </svg>
              <span>Student</span>
            </label>
          </div>
          <div>
            <input
              class="role-option"
              type="radio"
              name="role"
              id="role-teacher"
              value="Teacher"
            />
            <label class="role-label" for="role-teacher">
              <svg
                width="22"
                height="22"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <rect x="2" y="3" width="20" height="14" rx="2" />
                <line x1="8" y1="21" x2="16" y2="21" />
                <line x1="12" y1="17" x2="12" y2="21" />
              </svg>
              <span>Teacher</span>
            </label>
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label class="form-label" for="fname"
            >First Name <span>*</span></label
          >
          <input
            id="fname"
            name="Fname"
            type="text"
            class="form-control"
            placeholder="First name"
            required
          />
        </div>
        <div class="form-group">
          <label class="form-label" for="lname">Last Name</label>
          <input
            id="lname"
            name="Lname"
            type="text"
            class="form-control"
            placeholder="Last name"
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label class="form-label" for="username"
            >Username <span>*</span></label
          >
          <div style="display: flex; gap: 8px; align-items: center">
            <input
              id="username"
              name="username"
              type="text"
              class="form-control"
              placeholder="Auto-generated"
              required
              minlength="3"
              maxlength="50"
              autocomplete="username"
              style="flex: 1"
              readonly
            />
            <button
              type="button"
              id="regen-btn"
              style="
                flex-shrink: 0;
                padding: 0 12px;
                height: 40px;
                border: 1px solid var(--border);
                border-radius: var(--radius);
                background: var(--surface-2);
                cursor: pointer;
                font-size: 18px;
                line-height: 1;
              "
              title="Generate new username"
            >
              &#x21BB;
            </button>
            <button
              type="button"
              id="copy-btn"
              style="
                flex-shrink: 0;
                padding: 0 12px;
                height: 40px;
                border: 1px solid var(--border);
                border-radius: var(--radius);
                background: var(--surface-2);
                cursor: pointer;
                font-size: 12px;
                font-weight: 600;
                white-space: nowrap;
              "
              title="Copy username"
            >
              Copy
            </button>
          </div>
          <div
            class="form-hint"
            id="username-hint"
            style="color: var(--text-3)"
          >
            Generated from your name &amp; ID.
          </div>
        </div>
        <div class="form-group">
          <label class="form-label" for="userid"
            >Student/Staff ID <span>*</span></label
          >
          <input
            id="userid"
            name="userid"
            type="number"
            class="form-control"
            placeholder="e.g. 12345"
            required
            min="1"
          />
        </div>
      </div>

      <div class="form-group">
        <label class="form-label" for="email">Email <span>*</span></label>
        <input
          id="email"
          name="email"
          type="email"
          class="form-control"
          placeholder="you@example.com"
          required
          autocomplete="email"
        />
      </div>

      <div class="form-row">
        <div class="form-group">
          <label class="form-label" for="phone"
            >Phone Number <span>*</span></label
          >
          <input
            id="phone"
            name="PhoneNo"
            type="text"
            class="form-control"
            placeholder="10–12 digits"
            required
            pattern="\d{10,12}"
          />
        </div>
        <div class="form-group">
          <label class="form-label" for="course">Course <span>*</span></label>
          <select id="course" name="Course" class="form-control" required>
            <option value="">— Select course —</option>
            <option value="CS">CS — Computer Science</option>
            <option value="SE">SE — Software Engineering</option>
            <option value="IT">IT — Information Technology</option>
            <option value="DS">DS — Data Science</option>
            <option value="AI">AI — Artificial Intelligence</option>
            <option value="CY">CY — Cybersecurity</option>
            <option value="NET">NET — Networking</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label class="form-label" for="password"
            >Password <span>*</span></label
          >
          <input
            id="password"
            name="password"
            type="password"
            class="form-control"
            placeholder="Min 6 chars"
            required
            minlength="6"
            autocomplete="new-password"
          />
          <div class="form-hint">At least 6 characters.</div>
        </div>
        <div class="form-group">
          <label class="form-label" for="confirm_password"
            >Confirm Password <span>*</span></label
          >
          <input
            id="confirm_password"
            name="confirm_password"
            type="password"
            class="form-control"
            placeholder="Repeat password"
            required
            autocomplete="new-password"
          />
        </div>
      </div>

      <button
        type="submit"
        class="btn btn-primary btn-block"
        style="margin-top: 4px"
      >
        Create Account
      </button>
    </form>

    <div class="auth-footer">
      Already have an account? <a href="/login">Log in</a>
    </div>
  </div>
</div>

<script>
  (function () {
    const fnameEl = document.getElementById("fname");
    const lnameEl = document.getElementById("lname");
    const useridEl = document.getElementById("userid");
    const usernameEl = document.getElementById("username");
    const regenBtn = document.getElementById("regen-btn");
    const copyBtn = document.getElementById("copy-btn");
    const hint = document.getElementById("username-hint");

    function slug(s) {
      return (s || "").toLowerCase().replace(/[^a-z0-9]/g, "");
    }

    function generate() {
      const f = slug(fnameEl.value).slice(0, 5) || "user";
      const l = slug(lnameEl.value).slice(0, 4);
      const id = (useridEl.value || "").toString().slice(-4).padStart(4, "0");
      usernameEl.value = f + l + id;
      hint.textContent = "Generated — you can still edit it manually.";
      usernameEl.removeAttribute("readonly");
    }

    [fnameEl, lnameEl, useridEl].forEach((el) =>
      el.addEventListener("input", generate),
    );
    regenBtn.addEventListener("click", function () {
      // Shuffle the suffix slightly on manual regen
      const suffix = Math.floor(Math.random() * 9000 + 1000);
      const f = slug(fnameEl.value).slice(0, 5) || "user";
      const l = slug(lnameEl.value).slice(0, 4);
      usernameEl.value = f + l + suffix;
      usernameEl.removeAttribute("readonly");
    });

    copyBtn.addEventListener("click", function () {
      if (!usernameEl.value) return;
      navigator.clipboard.writeText(usernameEl.value).then(function () {
        copyBtn.textContent = "Copied!";
        setTimeout(function () {
          copyBtn.textContent = "Copy";
        }, 1800);
      });
    });
  })();
</script>
{% endblock %}
